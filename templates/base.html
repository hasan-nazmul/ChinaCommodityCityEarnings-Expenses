<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>China Commodity City</title>

    <!-- Google Fonts: Plus Jakarta Sans (Modern, Geometric, Clean) -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <!-- Bootstrap 5.3 CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <!-- Bootstrap Icons -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css"
    />

    <style>
      :root {
        /* Modern Color Palette */
        --primary-bg: #f8f9fa;
        --card-bg: #ffffff;
        --text-main: #1e293b;
        --text-muted: #64748b;
        
        --brand-color: #0f172a; /* Deep Navy */
        --accent-color: #3b82f6; /* Bright Blue */
        --success-color: #10b981; /* Emerald */
        --warning-color: #f59e0b; /* Amber */
        
        --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
        --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
      }

      body {
        font-family: 'Plus Jakarta Sans', sans-serif;
        background-color: #f1f5f9; /* Slate-100 */
        color: var(--text-main);
        -webkit-font-smoothing: antialiased;
        padding-bottom: 2rem;
      }

      /* --- NAVBAR STYLING --- */
      .navbar {
        background-color: var(--brand-color);
        padding: 0.75rem 0;
        box-shadow: var(--shadow-md);
      }
      
      .navbar-brand {
        font-weight: 700;
        font-size: 1.25rem;
        letter-spacing: -0.5px;
        color: white !important;
      }

      .nav-link {
        font-weight: 500;
        font-size: 0.95rem;
        color: #94a3b8 !important; /* Slate-400 */
        transition: all 0.2s ease;
        padding: 0.5rem 1rem !important;
        border-radius: 0.5rem;
      }

      .nav-link:hover, .nav-link.active {
        color: white !important;
        background-color: rgba(255, 255, 255, 0.1);
      }

      /* Sell Desk Button */
      .btn-sell-desk {
        background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        color: white !important;
        box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        border: none;
      }
      
      .btn-sell-desk:hover {
        transform: translateY(-1px);
        box-shadow: 0 6px 15px rgba(16, 185, 129, 0.4);
      }

      /* --- CARD STYLING --- */
      .card {
        background-color: var(--card-bg);
        border: none;
        border-radius: 1rem; /* 16px */
        box-shadow: var(--shadow-sm);
        transition: transform 0.2s ease, box-shadow 0.2s ease;
        overflow: hidden;
      }

      .card:hover {
        /* Subtle lift effect on hover */
        box-shadow: var(--shadow-md);
      }

      .card-header {
        background-color: transparent;
        border-bottom: 1px solid #e2e8f0;
        padding: 1.25rem 1.5rem;
      }

      .card-body {
        padding: 1.5rem;
      }

      .card-footer {
        background-color: transparent;
        border-top: 1px solid #e2e8f0;
      }

      /* --- TABLE STYLING --- */
      .table {
        margin-bottom: 0;
        border-collapse: separate; 
        border-spacing: 0;
      }
      
      .table thead th {
        background-color: #f8fafc;
        color: #64748b;
        font-weight: 600;
        font-size: 0.75rem;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        border-bottom: 1px solid #e2e8f0;
      }

      .table tbody td {
        vertical-align: middle;
        padding: 1rem 0.75rem;
        border-bottom: 1px solid #f1f5f9;
        font-size: 0.9rem;
      }

      /* NEW: Soft Blue Hover Effect + Clickable Row */
      .table-hover tbody tr {
        transition: background-color 0.15s ease-in-out;
      }
      
      .table-hover tbody tr:hover {
        background-color: rgba(59, 130, 246, 0.04) !important; /* Soft Brand Blue */
        cursor: pointer;
      }
      
      .table tbody tr:last-child td {
        border-bottom: none;
      }

      /* --- BUTTONS & BADGES --- */
      .btn {
        border-radius: 0.5rem;
        padding: 0.5rem 1rem;
        font-weight: 600;
        transition: all 0.2s;
      }

      .btn-primary {
        background-color: var(--accent-color);
        border-color: var(--accent-color);
      }

      .badge {
        font-weight: 600;
        padding: 0.5em 0.8em;
      }

      /* Utilities */
      .text-small { font-size: 0.875rem; }
      .fw-bold { font-weight: 700 !important; }
      
      .dropdown-menu {
        border: none;
        box-shadow: var(--shadow-lg);
        border-radius: 0.75rem;
        padding: 0.5rem;
      }
      .dropdown-item {
        border-radius: 0.5rem;
        padding: 0.5rem 1rem;
      }
      .dropdown-item:hover {
        background-color: #f1f5f9;
      }
    </style>
  </head>
  <body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg sticky-top">
      <div class="container">
        <a class="navbar-brand d-flex align-items-center gap-2" href="{% url 'dashboard' %}">
           <i class="bi bi-buildings-fill text-white-50"></i>
           <span>CCC<span class="text-white-50 ms-1 fw-light">System</span></span>
        </a>
        
        <button
          class="navbar-toggler border-0 text-white"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
        >
          <i class="bi bi-list fs-3"></i>
        </button>

        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav ms-auto align-items-center gap-1">
            {% if user.is_authenticated %}
            <li class="nav-item">
              <a class="nav-link {% if request.resolver_match.url_name == 'dashboard' %}active{% endif %}" href="{% url 'dashboard' %}">
                Dashboard
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link {% if 'inventory' in request.path %}active{% endif %}" href="{% url 'inventory_list' %}">
                Inventory
              </a>
            </li>
             <!-- Only Owner sees Approvals -->
             {% if user.role == 'OWNER' %}
             <li class="nav-item">
               <a class="nav-link position-relative {% if 'approvals' in request.path %}active{% endif %}" href="{% url 'admin_approval_list' %}">
                 Approvals
                 {% if pending_approvals > 0 %}
                 <span class="position-absolute top-0 start-100 translate-middle p-1 bg-danger border border-light rounded-circle" style="width: 10px; height: 10px;">
                   <span class="visually-hidden">New alerts</span>
                 </span>
                 {% endif %}
               </a>
             </li>
             {% endif %}
            
            <!-- Separator -->
            <li class="nav-item d-none d-lg-block mx-2 text-white-50">|</li>

            <li class="nav-item">
                <a class="nav-link btn-sell-desk px-4 ms-2" href="{% url 'sell_product' %}">
                  <i class="bi bi-cart-fill me-2"></i>POS
                </a>
            </li>
            
            <!-- User Dropdown -->
            <li class="nav-item dropdown ms-lg-3">
                <a class="nav-link dropdown-toggle d-flex align-items-center gap-2 text-white" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                    <div class="bg-white text-dark rounded-circle d-flex align-items-center justify-content-center fw-bold" style="width: 32px; height: 32px;">
                        {{ user.username|first|upper }}
                    </div>
                    <span class="d-none d-lg-block">{{ user.username }}</span>
                </a>
                <ul class="dropdown-menu dropdown-menu-end mt-2">
                  <li><h6 class="dropdown-header small text-muted text-uppercase">Signed in as {{ user.get_role_display }}</h6></li>
                  <li><a class="dropdown-item" href="{% url 'profile' %}"><i class="bi bi-person-gear me-2"></i>Profile Settings</a></li>
                  {% if user.role != 'OWNER' %}
                  <li><a class="dropdown-item" href="{% url 'my_requests' %}"><i class="bi bi-clock-history me-2"></i>My History</a></li>
                  {% endif %}
                  <li><hr class="dropdown-divider"></li>
                  <li>
                    <form action="{% url 'logout' %}" method="post">
                        {% csrf_token %}
                        <button type="submit" class="dropdown-item text-danger fw-bold"><i class="bi bi-box-arrow-right me-2"></i>Sign Out</button>
                    </form>
                  </li>
                </ul>
            </li>

            {% else %}
            <li class="nav-item">
              <a class="nav-link active" href="{% url 'login' %}">Login</a>
            </li>
            {% endif %}
            
          </ul>
        </div>
      </div>
    </nav>

    <!-- Main Layout -->
    <div class="container py-4">
      
      <!-- Alert Messages -->
      {% if messages %} 
      <div class="row justify-content-center mb-4">
          <div class="col-lg-8">
              {% for message in messages %}
              <div class="alert alert-{{ message.tags }} alert-dismissible fade show shadow-sm border-0 d-flex align-items-center" role="alert">
                {% if message.tags == 'success' %}
                    <i class="bi bi-check-circle-fill text-success fs-4 me-3"></i>
                {% elif message.tags == 'error' %}
                    <i class="bi bi-x-circle-fill text-danger fs-4 me-3"></i>
                {% elif message.tags == 'warning' %}
                    <i class="bi bi-exclamation-triangle-fill text-warning fs-4 me-3"></i>
                {% else %}
                    <i class="bi bi-info-circle-fill text-info fs-4 me-3"></i>
                {% endif %}
                <div>
                    <strong>{{ message }}</strong>
                </div>
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
              </div>
              {% endfor %} 
          </div>
      </div>
      {% endif %}

      <!-- Dynamic Content -->
      {% block content %}{% endblock %}
      
    </div>

    <!-- Footer -->
        <!-- Footer -->
    <footer class="text-center py-4 mt-auto border-top bg-white">
      <div class="container">
          <!-- Copyright -->
          <p class="text-muted small mb-2">
              &copy; {% now "Y" %} China Commodity City Management System. 
              <span class="d-none d-sm-inline">All rights reserved.</span>
          </p>
          
          <!-- Developer Info -->
          <div class="small text-muted d-flex justify-content-center align-items-center gap-2">
              <span>Developed by <span class="fw-bold text-dark">Nazmul Hasan</span></span>
              <span class="text-muted opacity-25">|</span>
              
              <!-- GitHub -->
              <a href="https://github.com/hasan-nazmul" target="_blank" class="text-secondary text-decoration-none hover-dark" title="GitHub">
                  <i class="bi bi-github fs-6"></i>
              </a>
              
              <!-- LinkedIn -->
              <a href="https://www.linkedin.com/in/nazmul-hasan-1329511aa" target="_blank" class="text-secondary text-decoration-none hover-dark" title="LinkedIn">
                  <i class="bi bi-linkedin fs-6"></i>
              </a>
          </div>
      </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Tooltip Init -->
    <script>
        const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
        const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    </script>
  </body>
</html>